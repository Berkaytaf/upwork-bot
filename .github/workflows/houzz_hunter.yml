name: ğŸ  Houzz Hunter (USA Lead Gen & Dashboard)

on:
  workflow_dispatch:
    inputs:
      category:
        description: 'Houzz Category (e.g., roofing-contractors)'
        required: true
        default: 'roofing-contractors'
      location:
        description: 'Location (e.g., Houston--TX)'
        required: true
        default: 'Houston--TX'

jobs:
  houzz_job:
    runs-on: ubuntu-latest
    permissions:
      contents: write
      
    steps:
      - name: ğŸ“‚ KodlarÄ± Ã‡ek
        uses: actions/checkout@v4

      - name: ğŸ Python Kur
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'

      - name: ğŸ“¦ KÃ¼tÃ¼phaneleri ve TarayÄ±cÄ±yÄ± YÃ¼kle
        run: |
          python -m pip install --upgrade pip
          pip install playwright pandas openpyxl
          playwright install --with-deps chromium

      - name: ğŸ¤– ABD AvcÄ±sÄ± Botu AteÅŸle
        # Girdiler tÄ±rnak iÃ§inde gÃ¶nderilir (BoÅŸluklu lokasyonlar iÃ§in)
        run: python houzz_scraper.py "${{ github.event.inputs.category }}" "${{ github.event.inputs.location }}"

      - name: ğŸ“Š Dashboard ve Verileri Kaydet
        run: |
          git config --global user.name "HouzzBot"
          git config --global user.email "bot@github.com"
          # Dashboard dosyasÄ±nÄ± (index_houzz.html) buraya ekledik kanka
          git add houzz_database.json houzz_leads.xlsx index_houzz.html || echo "Dosyalar bulunamadÄ±"
          git commit -m "âœ… USA Leads & Dashboard Updated: ${{ github.event.inputs.location }}" || echo "DeÄŸiÅŸiklik yok"
          git push || echo "Push baÅŸarÄ±sÄ±z"

      - name: ğŸ“¥ Excel DosyasÄ±nÄ± HazÄ±rla (Artifact)
        # Ä°ÅŸlem bitince Summary kÄ±smÄ±ndan taze Excel'i indirebilirsin
        uses: actions/upload-artifact@v4
        with:
          name: Houzz-${{ github.event.inputs.location }}-Leads
          path: houzz_leads.xlsx
